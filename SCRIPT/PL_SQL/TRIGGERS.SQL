create or replace TRIGGER TR_HISTORICOCRV_AUDITOR 
BEFORE INSERT OR UPDATE OR DELETE ON HISTORICOCRV FOR EACH ROW 
BEGIN
    IF INSERTING THEN
        INSERT INTO AUDITORIA (IDAUDITORIA,TABLAMODIFICADA,IDREGISTROMODIFICADO,USUARIOMODIFICADOR,FECHAMODIFICACION) VALUES
        (SEQ_AUDITORIA_IDAUDITORIA.NEXTVAL,'HISTORICOCRV',:NEW.IDHISTORICOCRV,USER,SYSDATE);
    ELSIF DELETING THEN
        INSERT INTO AUDITORIA (IDAUDITORIA,TABLAMODIFICADA,IDREGISTROMODIFICADO,REGISTROANTIGUO,USUARIOMODIFICADOR,FECHAMODIFICACION) VALUES
        (SEQ_AUDITORIA_IDAUDITORIA.NEXTVAL,'HISTORICOCRV',:OLD.IDHISTORICOCRV,
        'IDCLienteA: '||:OLD.IDCLIENTE||',IDRepresentanteVentasA: '||:OLD.IDREPRESENTANTEVENTAS||',FechaInicioA: '||:OLD.FECHAINICIO||',FechaFinA: '||TO_CHAR(NVL(:OLD.FECHAFIN,''),'DD/MM/YYYY'),
        USER,SYSDATE);
    ELSIF UPDATING THEN
        INSERT INTO AUDITORIA (IDAUDITORIA,TABLAMODIFICADA,IDREGISTROMODIFICADO,REGISTROANTIGUO,REGISTRONUEVO,USUARIOMODIFICADOR,FECHAMODIFICACION) VALUES
        (SEQ_AUDITORIA_IDAUDITORIA.NEXTVAL,'HISTORICOCRV',:OLD.IDHISTORICOCRV,
        'IDCLienteA: '||:OLD.IDCLIENTE||',IDRepresentanteVentasA: '||:OLD.IDREPRESENTANTEVENTAS||',FechaInicioA: '||TO_CHAR(:OLD.FECHAINICIO,'DD/MM/YYYY')||',FechaFinA: '||TO_CHAR(NVL(:OLD.FECHAFIN,''),'DD/MM/YYYY'),
        'IDCLienteN: '||:NEW.IDCLIENTE||',IDRepresentanteVentasN: '||:NEW.IDREPRESENTANTEVENTAS||',FechaInicioN: '||TO_CHAR(:NEW.FECHAINICIO,'DD/MM/YYYY')||',FechaFinN: '||TO_CHAR(NVL(:NEW.FECHAFIN,''),'DD/MM/YYYY'),
        USER,SYSDATE);
    END IF;
END;
/
create or replace TRIGGER TR_HISTORICOTIPOREP_AUDITOR 
BEFORE DELETE OR INSERT OR UPDATE ON HISTORICOTIPOREP FOR EACH ROW
BEGIN
    IF INSERTING THEN
        INSERT INTO AUDITORIA (IDAUDITORIA,TABLAMODIFICADA,IDREGISTROMODIFICADO,USUARIOMODIFICADOR,FECHAMODIFICACION) VALUES
        (SEQ_AUDITORIA_IDAUDITORIA.NEXTVAL,'HISTORICOTIPOREP',:NEW.IDHISTORICOTIPOREP,USER,SYSDATE);
    ELSIF DELETING THEN
        INSERT INTO AUDITORIA (IDAUDITORIA,TABLAMODIFICADA,IDREGISTROMODIFICADO,REGISTROANTIGUO,USUARIOMODIFICADOR,FECHAMODIFICACION) VALUES
        (SEQ_AUDITORIA_IDAUDITORIA.NEXTVAL,'HISTORICOTIPOREP',:OLD.IDHISTORICOTIPOREP,
        'IDRepresentanteA: '||:OLD.IDREPRESENTANTEVENTAS||',IDTipoRepresentanteA: '||:OLD.IDTIPOREPRESENTANTE||',FechaCambioA: '||TO_CHAR(:OLD.FECHACAMBIO,'DD/MM/YYYY'),
        USER,SYSDATE);
    ELSIF UPDATING THEN
        INSERT INTO AUDITORIA (IDAUDITORIA,TABLAMODIFICADA,IDREGISTROMODIFICADO,REGISTROANTIGUO,REGISTRONUEVO,USUARIOMODIFICADOR,FECHAMODIFICACION) VALUES
        (SEQ_AUDITORIA_IDAUDITORIA.NEXTVAL,'HISTORICOTIPOREP',:OLD.IDHISTORICOTIPOREP,
        'IDRepresentanteA: '||:OLD.IDREPRESENTANTEVENTAS||',IDTipoRepresentanteA: '||:OLD.IDTIPOREPRESENTANTE||',FechaCambioA: '||TO_CHAR(:OLD.FECHACAMBIO,'DD/MM/YYYY'),
        'IDRepresentanteN: '||:NEW.IDREPRESENTANTEVENTAS||',IDTipoRepresentanteN: '||:NEW.IDTIPOREPRESENTANTE||',FechaCambioN: '||TO_CHAR(:NEW.FECHACAMBIO,'DD/MM/YYYY'),
        USER,SYSDATE);
    END IF;
END;
/
CREATE OR REPLACE TRIGGER TR_VENTA_AUDITOR 
BEFORE DELETE OR INSERT OR UPDATE ON VENTA FOR EACH ROW
BEGIN
    IF INSERTING THEN
        INSERT INTO AUDITORIA (IDAUDITORIA,TABLAMODIFICADA,IDREGISTROMODIFICADO,USUARIOMODIFICADOR,FECHAMODIFICACION) VALUES
        (SEQ_AUDITORIA_IDAUDITORIA.NEXTVAL,'VENTA',:NEW.IDVENTA,USER,SYSDATE);
    ELSIF DELETING THEN
        INSERT INTO AUDITORIA (IDAUDITORIA,TABLAMODIFICADA,IDREGISTROMODIFICADO,REGISTROANTIGUO,USUARIOMODIFICADOR,FECHAMODIFICACION) VALUES
        (SEQ_AUDITORIA_IDAUDITORIA.NEXTVAL,'VENTA',:OLD.IDVENTA,
        'FechaVentaA: '||TO_CHAR(:OLD.FECHAVENTA,'DD/MM/YYYY')||',TotalA: '||:OLD.TOTAL||',IDCLienteA: '||:OLD.IDCLIENTE||',EstadoVentaA: '||:OLD.ESTADOVENTA,
        USER,SYSDATE);
    ELSIF UPDATING THEN
        INSERT INTO AUDITORIA (IDAUDITORIA,TABLAMODIFICADA,IDREGISTROMODIFICADO,REGISTROANTIGUO,REGISTRONUEVO,USUARIOMODIFICADOR,FECHAMODIFICACION) VALUES
        (SEQ_AUDITORIA_IDAUDITORIA.NEXTVAL,'VENTA',:OLD.IDVENTA,
        'FechaVentaA: '||TO_CHAR(:OLD.FECHAVENTA,'DD/MM/YYYY')||',TotalA: '||:OLD.TOTAL||',IDCLienteA: '||:OLD.IDCLIENTE||',EstadoVentaA: '||:OLD.ESTADOVENTA,
        'FechaVentaN: '||TO_CHAR(:NEW.FECHAVENTA,'DD/MM/YYYY')||',TotalN: '||:NEW.TOTAL||',IDCLienteAN '||:NEW.IDCLIENTE||',EstadoVentaN: '||:NEW.ESTADOVENTA,
        USER,SYSDATE);
    END IF;
END;
/
CREATE OR REPLACE TRIGGER TR_CALIFICACIONVENTA_AUDITOR 
BEFORE DELETE OR INSERT OR UPDATE ON CALIFICACIONVENTA FOR EACH ROW
BEGIN
    IF INSERTING THEN
        INSERT INTO AUDITORIA (IDAUDITORIA,TABLAMODIFICADA,IDREGISTROMODIFICADO,USUARIOMODIFICADOR,FECHAMODIFICACION) VALUES
        (SEQ_AUDITORIA_IDAUDITORIA.NEXTVAL,'CALIFICACIONVENTA',:NEW.IDCALIFICACIONVENTA,USER,SYSDATE);
    ELSIF DELETING THEN
        INSERT INTO AUDITORIA (IDAUDITORIA,TABLAMODIFICADA,IDREGISTROMODIFICADO,REGISTROANTIGUO,USUARIOMODIFICADOR,FECHAMODIFICACION) VALUES
        (SEQ_AUDITORIA_IDAUDITORIA.NEXTVAL,'CALIFICACIONVENTA',:OLD.IDCALIFICACIONVENTA,
        'CalificacionA: '||:OLD.CALIFICACION||',DetalleCalificacionA: '||:OLD.DETALLECALIFICACION||',IDVentaA: '||:OLD.IDVENTA||',FechaA: '||TO_CHAR(NVL(:OLD.FECHA,''),'DD/MM/YYYY'),
        USER,SYSDATE);
    ELSIF UPDATING THEN
        INSERT INTO AUDITORIA (IDAUDITORIA,TABLAMODIFICADA,IDREGISTROMODIFICADO,REGISTROANTIGUO,REGISTRONUEVO,USUARIOMODIFICADOR,FECHAMODIFICACION) VALUES
        (SEQ_AUDITORIA_IDAUDITORIA.NEXTVAL,'CALIFICACIONVENTA',:OLD.IDCALIFICACIONVENTA,
        'CalificacionA: '||:OLD.CALIFICACION||',DetalleCalificacionA: '||:OLD.DETALLECALIFICACION||',IDVentaA: '||:OLD.IDVENTA||',FechaA: '||TO_CHAR(NVL(:OLD.FECHA,''),'DD/MM/YYYY'),
        'CalificacionN: '||:NEW.CALIFICACION||',DetalleCalificacionN: '||:NEW.DETALLECALIFICACION||',IDVentaN: '||:NEW.IDVENTA||',FechaN: '||TO_CHAR(NVL(:NEW.FECHA,''),'DD/MM/YYYY'),
        USER,SYSDATE);
    END IF;
END;
/